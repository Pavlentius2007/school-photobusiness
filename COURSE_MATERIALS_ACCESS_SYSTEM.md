# Система контроля доступа к материалам курсов

## Обзор

Реализована система контроля доступа к материалам курсов, которая позволяет администратору вручную активировать доступ к материалам для каждого курса отдельно. Если галочка не стоит, то ученик не видит материалы по курсам.

## Основные компоненты

### 1. Интерфейс пользователя (User Interface)

#### Обновленный интерфейс User
```typescript
interface User {
  // ... существующие поля
  courseMaterialsAccess: {
    course1: boolean;
    course2: boolean;
    course3: boolean;
  };
}
```

#### Новые поля в моковых данных
- `courseMaterialsAccess` - объект с булевыми значениями для каждого курса
- По умолчанию у студентов доступ закрыт ко всем курсам
- Администраторы и кураторы имеют доступ ко всем материалам

### 2. Хук useCourseAccess

**Файл:** `frontend/src/hooks/useCourseAccess.ts`

Функции:
- `hasAccessToCourseMaterials(courseId: number)` - проверяет доступ к конкретному курсу
- `getAccessibleCourses()` - возвращает список доступных курсов для пользователя

#### Логика доступа:
- **Администраторы и кураторы:** полный доступ ко всем материалам
- **Студенты:** доступ только к тем курсам, где включена галочка в админке

### 3. Компонент CourseMaterials

**Файл:** `frontend/src/components/CourseMaterials.tsx`

Отображает материалы курса с проверкой доступа:

#### Состояния отображения:
1. **Доступ закрыт** - показывает сообщение о необходимости обратиться к администратору
2. **Материалы отсутствуют** - показывает сообщение о том, что материалы не загружены
3. **Материалы доступны** - отображает список материалов с возможностью просмотра

### 4. Обновленная страница управления пользователями

**Файл:** `frontend/src/pages/admin/UsersManagementPage.tsx`

#### Новые функции:
- `handleToggleCourseMaterialAccess()` - переключает доступ к материалам курса
- Обновленное модальное окно редактирования с чекбоксами для каждого курса
- Отображение статуса доступа в таблице пользователей

#### Интерфейс администратора:
- Чекбоксы для каждого из 3 курсов в модальном окне редактирования
- Визуальные индикаторы статуса доступа в таблице пользователей
- Возможность быстрого переключения доступа

## Использование

### Для администратора:

1. **Открыть страницу управления пользователями** (`/admin/users`)
2. **Нажать кнопку "✏️"** рядом с пользователем
3. **В модальном окне найти секцию "Доступ к материалам курсов"**
4. **Поставить галочки** для нужных курсов
5. **Нажать "Сохранить"**

### Для студентов:

1. **Перейти на страницу курса** (`/course/1`, `/course/2`, `/course/3`)
2. **Найти секцию "Материалы курса"**
3. **Если доступ открыт** - материалы будут отображаться
4. **Если доступ закрыт** - появится сообщение с контактами администратора

## Структура данных

### В базе данных (мок):
```typescript
courseMaterialsAccess: {
  course1: false, // Особенности фотографии в школах/садах
  course2: false, // Дизайн и создание макетов  
  course3: false  // Администрирование, ценообразование + инструменты управления
}
```

### В интерфейсе:
- ✅ - доступ открыт
- ❌ - доступ закрыт

## Безопасность

- Доступ проверяется на уровне компонента
- Студенты не могут обойти ограничения через URL
- Администраторы и кураторы имеют полный доступ
- Система работает независимо от общего доступа к курсам

## Интеграция

### С существующими компонентами:
- Интегрирован с `CourseDetailPage.tsx`
- Использует `AuthContext` для получения данных пользователя
- Совместим с системой управления курсами

### С будущими функциями:
- Готов к интеграции с реальным API
- Может быть расширен для большего количества курсов
- Поддерживает добавление новых типов материалов

## Тестирование

### Сценарии тестирования:

1. **Студент без доступа:**
   - Переход на страницу курса
   - Отображение сообщения о закрытом доступе
   - Отсутствие материалов

2. **Студент с доступом:**
   - Переход на страницу курса
   - Отображение материалов
   - Возможность открытия файлов

3. **Администратор:**
   - Полный доступ ко всем материалам
   - Возможность управления доступом пользователей

4. **Куратор:**
   - Полный доступ ко всем материалам
   - Невозможность управления доступом других пользователей

## Контакты для поддержки

При возникновении проблем с доступом к материалам:
- **Email:** admin@sianoro.ru
- **Telegram:** @Pavlentius2007 